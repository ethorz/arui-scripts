ARUI-scripts
===

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –Ω–∞—à–µ–º —Å—Ç–µ–∫–µ –±–µ–∑ –∫–∞–∫–æ–π –ª–∏–±–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–∏–ª–¥–µ—Ä–æ–≤.

–í–æ –º–Ω–æ–≥–æ–º –ø–∞–∫–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω `react-scripts` –∏–∑ `create-react-app`, —Ä–∞–∑–Ω–∏—Ü–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è
–≤ –Ω–µ–º–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∞—é—â–∏—Ö—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –¥–ª—è `babel`, –ø–æ–¥–¥–µ—Ä–∂–∫–∏ `ts` –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º –∫–æ–¥–æ–º.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
===

0. –ü–∞–∫–µ—Ç —Ç—Ä–µ–±—É–µ—Ç –≤–µ—Ä—Å–∏—é nodejs 10+.

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `arui-scripts` –≤ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç –∫–∞–∫ dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å

```bash
yarn add arui-scripts --dev
```
–∏–ª–∏
```bash
npm install arui-scripts --save-dev
```

2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã
- `src/index.{js,jsx,ts,tsx}` - –≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- `src/server/index.{js,jsx,tsx}` - –≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- `node_modules/arui-feather/polyfills` - –ø–æ–ª–∏—Ñ–∏–ª—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ü—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç–∏ –ø—É—Ç–∏ —Å –ø–æ–º–æ—â—å—é –Ω–∞—Å—Ç—Ä–æ–µ–∫.

3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –∏–∑ `arui-scripts`!

–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
---

- `arui-scripts start` - –∑–∞–ø—É—Å–∫–∞–µ—Ç WebpackDevServer –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏ webpack –≤ —Ä–µ–∂–∏–º–µ `--watch` –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞.
- `arui-scripts build` - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –∫–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ production
- `arui-scripts docker-build` - —Å–æ–±–∏—Ä–∞–µ—Ç docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä c production –±–∏–ª–¥–æ–º –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –µ–≥–æ –≤ –∞—Ä—Ç–∏—Ñ–∞–∫—Ç–æ—Ä–∏
- `arui-scripts test` - –∑–∞–ø—É—Å–∫–∞–µ—Ç jest —Ç–µ—Å—Ç—ã.
- `arui-scripts archive-build` - —Å–æ–±–∏—Ä–∞–µ—Ç –∞—Ä—Ö–∏–≤ —Å production –±–∏–ª–¥–æ–º
- `arui-scripts bundle-analyze` - –∑–∞–ø—É—Å–∫–∞–µ—Ç [webpack-bundle-analyzer](https://www.npmjs.com/package/webpack-bundle-analyzer) –¥–ª—è prod –≤–µ—Ä—Å–∏–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–¥–∞


–ù–∞—Å—Ç—Ä–æ–π–∫–∏
---

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏, –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞—Ö–æ—Ç–µ—Ç—å –ø–æ–º–µ–Ω—è—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±–æ—Ä—â–∏–∫–æ–≤.
–°–¥–µ–ª–∞—Ç—å —ç—Ç–æ –º–æ–∂–Ω–æ –≤ `package.json`, –æ–ø—Ä–µ–¥–µ–ª–∏–≤ —Ç–∞–º —Å–≤–æ–π—Å—Ç–≤–æ `aruiScripts`.

–î–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- `dockerRegistry` - –∞–¥—Ä–µ—Å –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ docker registry, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `''`, —Ç–æ –µ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—É–±–ª–∏—á–Ω—ã–π registry
- `baseDockerImage` - –∏–º—è –±–∞–∑–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è docker –æ–±—Ä–∞–∑–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `alfabankui/arui-scripts:latest`.
- `serverEntry` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `src/server/index`.
- `serverOutput` - –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `server.js`.
- `clientPolyfillsEntry` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –ø–æ–ª–∏—Ñ–∏–ª–æ–≤. –ë—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –¥–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç –ø–æ–ª–∏—Ñ–∏–ª—ã –∏–∑ `arui-feather`, –µ—Å–ª–∏ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω.
- `clientEntry` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `src/index.js`.
- `useServerHMR` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ HotModuleReplacement –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `false`.
- `clientServerPort` - –ø–æ—Ä—Ç WebpackDevServer –∏ nginx –∏—Ç–æ–≥–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `8080`.
- `serverPort` - –ø–æ—Ä—Ç –Ω–æ–¥–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞. –ù—É–∂–µ–Ω –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –¥–µ–≤ —Å–µ—Ä–≤–µ—Ä–∞ –∏ nginx. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `3000`.
- `additionalBuildPath` - –º–∞—Å—Å–∏–≤ –ø—É—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ø–∞–¥—É—Ç –≤ –∞—Ä—Ö–∏–≤ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `archive-build`. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `['config']`.
- `archiveName` - –∏–º—è –∞—Ä—Ö–∏–≤–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `archive-build`. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `build.tar`.
- `keepPropTypes` - –µ—Å–ª–∏ `true`, –ø–∞–∫–µ—Ç—ã —Å prop-types –Ω–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –∏–∑ production –±–∏–ª–¥–∞.
- `debug` - —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è –±–æ–ª—å—à–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `false`.
- `useTscLoader` -  –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ts-loader –≤–º–µ—Å—Ç–æ babel-loader –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ ts —Ñ–∞–π–ª–æ–≤. –£ babel-loader –µ—Å—Ç—å [—Ä—è–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π](https://blogs.msdn.microsoft.com/typescript/2018/08/27/typescript-and-babel-7/). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `false`.
- `componentsTheme` - –ø—É—Ç—å –∫ css —Ñ–∞–π–ª—É —Å —Ç–µ–º–æ–π –¥–ª—è [core-components](https://alfa-laboratory.github.io/core-components). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ [postcss-custom-properties](https://github.com/postcss/postcss-custom-properties#importfrom).
- `keepCssVars` - –æ—Ç–∫–ª—é—á–∞–µ—Ç `postcss-custom-properties`, css –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±—É–¥—É—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ –±–∞–Ω–¥–ª–µ.

–í —Ü–µ–ª—è—Ö –æ—Ç–ª–∞–¥–∫–∏ –≤—Å–µ —ç—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–µ –∏–∑–º–µ–Ω—è—è package.json
–ü—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ environment –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π ARUI_SCRIPTS_CONFIG
```
ARUI_SCRIPTS_CONFIG="{\"serverPort\":3333}" yarn start
```

–¢–∞–∫ –∂–µ, —á–∏—Ç–∞—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ jest (—Å–º. [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é](https://facebook.github.io/jest/docs/en/configuration.html))
–∏ `proxy` (—Å–º. [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é](https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/template/README.md#proxying-api-requests-in-development)).

–ù–µ—Å–∫–æ–ª—å–∫–æ entry point
---
–ö–ª—é—á–∏ `serverEntry` –∏ `clientEntry` –ø—Ä–∏–Ω–∏–º–∞—é—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏, –Ω–æ –∏ –ª—é–±—ã–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤ [webpack –≤–∞—Ä–∏–∞–Ω—Ç—ã](https://webpack.js.org/concepts/entry-points/).
–ù–∞–ø—Ä–∏–º–µ—Ä, package.json:
```json
{
    "aruiScripts": {
        "clientEntry": { "mobile": "src/mobile/", "desktop": "src/desktop/" },
        "serverEntry": ["src/server-prepare", "src/server"]
    }
}
```

–ö–æ –≤—Å–µ–º –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–º entryPoint —Ç–∞–∫ –∂–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã `clientPolyfillsEntry` (–µ—Å–ª–∏ –∑–∞–¥–∞–Ω)
–∏, –≤ dev —Ä–µ–∂–∏–º–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è hot-module-reload —Ñ–∞–π–ª—ã.

–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–≤
---

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Babel, –¥–ª—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞ –º–æ–∂–µ—Ç–µ –ø–æ–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª `.babelrc` –≤ —Ä—É—Ç –ø–∞–ø–∫—É —Å–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.
TypeScript –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å, –ø–æ–ª–æ–∂–∏–≤ `tsconfig.json` –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞.

–ü—É—Ç–∏ –¥–æ –∞—Å—Å–µ—Ç–æ–≤
---
–í–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–æ–¥–∞–∫—à–Ω –≤–µ—Ä—Å–∏–∏ –±–∏–ª–¥–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω–æ –¥–≤–∞ –±–∞–Ω–¥–ª–∞ `vendor.[hash].js` –∏ `main.[hash].js`. –î–ª—è
—Ç–æ–≥–æ, —á—Ç–æ–±—ã –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π html —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º —ç—Ç–∏—Ö –∞—Å—Å–µ—Ç–æ–≤ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª `webpack-assets.json`
–∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª–æ–∂–µ–Ω –≤ –ø–∞–ø–∫—É —Å–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–æ–¥–æ–º.

`vendor.js` –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤—Å–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤–∞–º–∏ `node_modules`, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –º–æ–¥—É–ª–µ–π, –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è `arui`.

`main.js` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ.

–í–∞–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –≤–∞—à–∏ –∞—Å—Å–µ—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, `vendor.js` –¥–æ–ª–∂–µ–Ω –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –î–û `main.js`.

–ü—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –º–∞—Å—Å–∏–≤—ã –¥–ª—è js –∏ css —Ñ–∞–π–ª–æ–≤:
```js
function readAssetsManifest() {
    // —á–∏—Ç–∞–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç
    const manifestPath = path.join(process.cwd(), '.build/webpack-assets.json');
    const manifest = JSON.parse(fs.readFileSync(manifestPath, 'utf8'));

    const js = [];
    const css = [];
    // vendor –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ –ø–µ—Ä–µ–¥ main
    ['vendor', 'main'].forEach((key) => {
        if (!manifest[key]) { // –≤ –¥–µ–≤ —Å–±–æ—Ä–∫–µ vendor.js –Ω–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è
            return;
        }
        if (manifest[key].js) {
            js.push(manifest[key].js);
        }
        if (manifest[key].css) {
            css.push(manifest[key].css);
        }
    });

    return {
        js, css
    };
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ hot-module-replacement
---
#### –ö–ª–∏–µ–Ω—Ç:

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –±—É–¥–µ—Ç –ø–æ–¥–º–µ–Ω—è—Ç—å—Å—è —Ç–æ–ª—å–∫–æ css. –î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å react –≤–∞–º –Ω–∞–¥–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–π –∫–æ–¥:
```jsx harmony
import React from 'react'
import ReactDOM from 'react-dom'
import App from './app';
import { AppContainer } from 'react-hot-loader';

ReactDOM.render(
    <AppContainer><App /></AppContainer>,
    document.getElementById('react-app')
);
if (module.hot) {
    module.hot.accept('./app', () => {
        const NextAppAssignments = require('./app').default;
        ReactDOM.render(
            <AppContainer><NextAppAssignments /></AppContainer>,
            document.getElementById('react-app')
        );
    });
}
```

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è `React-Hot-Loader: react-üî•-dom patch is not detected. React 16.6+ features may not work.` —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `webpack.client.dev` –Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `resolve.alias`, –≤ –Ω—ë–º –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∞—è –∑–∞–ø–∏c—å:

```
// ...
  resolve: {
    alias: {
      'react-dom': '@hot-loader/react-dom'
    }
  }
```

#### –°–µ—Ä–≤–µ—Ä
–°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±—É–¥–µ—Ç –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞,
–¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è hot module replacement –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—â–µ–π:

–í `package.json` –¥–æ–±–∞–≤–∏—Ç—å:
```json
{
    "aruiScripts": { "useServerHMR": true }
}
```

–í–∞—à–∞ –≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫ (–Ω–∞ –ø—Ä–∏–º–µ—Ä–µ hapi):
##### server/index.js
```js
import server from './server';

let currentServer = server;

async function startServer() {
    try {
        await currentServer.start();
    } catch (error) {
        console.error('Failed to start server', error);
        process.exit(1);
    }
}

startServer();

if (module.hot) {
    module.hot.accept(['./server'], async () => {
        try {
            await currentServer.stop();

            currentServer = server; // –∏–º–ø–æ—Ä—Ç –∏–∑ —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–º–µ–Ω–∏—Ç—Å—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ
            await startServer();
        } catch (error) {
            console.log('Failed to update server. You probably need to restart application', error);
        }
    });
}
```
##### server/server.js
```js
import hapi from 'hapi';
const server = new hapi.Server();

server.ext('onPostStart', (_, done) => {
    console.log(`Server is running: ${server.info.uri}`);
    done();
});

(async () => {
    server.connection({ port: 3000 });

    // ...
    // –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
    // ...
})();

export default server;
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ —Å–µ—Ä–≤–µ—Ä –Ω–µ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è, —á—Ç–æ –≤–æ –º–Ω–æ–≥–∏—Ö —Å–ª—É—á–∞—è—Ö –±—ã—Å—Ç—Ä–µ–µ.
–í —Å–ª—É—á–∞–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ö–æ–¥–Ω–æ–π —Ç–æ—á–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ HMR –≤–∞–º –Ω–∞–¥–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —Å–µ—Ä–≤–µ—Ä –≤—Ä—É—á–Ω—É—é.

–¢–µ—Å—Ç—ã
---
–ö–æ–º–∞–Ω–¥–∞ `arui-scripts test` –≤–Ω—É—Ç—Ä–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç jest —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π.

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `jest-snapshot-serializer-class-name-to-string` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å `cn`
- –ó–∞–º–µ–Ω—É –≤—Å–µ—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ css —Ñ–∞–π–ª–æ–≤ –Ω–∞ –ø—É—Å—Ç—ã–µ —Ñ–∞–π–ª—ã
- –ö–æ–º–ø–∏–ª—è—Ü–∏—é .js/.jsx —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—è babel
- –ö–æ–º–ø–∏–ª—è—Ü–∏—é .ts/.tsx —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—è tsc
- –ó–∞–º–µ–Ω—É –∏–º–ø–æ—Ä—Ç–æ–≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ –Ω–∞ –∏–º–ø–æ—Ä—Ç —Å—Ç—Ä–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–∞

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–¥ –º–∞—Å–∫—É –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –ø–æ–ø–∞–¥–∞—é—Ç –≤—Å–µ —Ñ–∞–π–ª—ã `*test*.(js|jsx|ts|tsx)`, `*spec*.((js|jsx|ts|tsx))`, `*/__test__/*.(js|jsx|ts|tsx)`.

–í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –ª—é–±—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ jest –≤ `package.json`, [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://facebook.github.io/jest/docs/en/configuration.html).

–ï—Å–ª–∏ –∫–∞–∫–∏–µ –ª–∏–±–æ –∏–∑ –≤–∞—à–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä VS–°ode –∏–ª–∏ WebStorm) –Ω–µ –º–æ–≥—É—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –≤—ã –º–æ–∂–µ—Ç–µ —Ç–∞–∫ –∂–µ —É–∫–∞–∑–∞—Ç—å `arui-scripts` –∫–∞–∫ preset –¥–ª—è jest.
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ arui-script, —Ç–∞–∫ –∏ –ª—é–±—ã–µ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –∑–∞–ø—É—Å–∫–∞—é—â–∏–µ jest.

##### package.json
```json
{
    "jest": {
        "preset": "arui-scripts"
    }
}
```

docker
---

–ö–æ–º–∞–Ω–¥–∞ `arui-scripts docker-build` –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏—é –ø—Ä–æ–¥–∞–∫—à–Ω –≤–µ—Ä—Å–∏–∏ –∏ —Å–±–æ—Ä–∫—É –¥–æ–∫–µ—Ä –æ–±—Ä–∞–∑–∞.

–û–±—Ä–∞–∑ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ [alpine-node-nginx](https://github.com/alfa-laboratory/arui-scripts/blob/master/packages/alpine-node-nginx/).

–ò–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ `{configs.dockerRegistry}/{name}:{version}`. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `name` –∏ `version` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–µ—Ä—É—Ç—Å—è –∏–∑ package.json,
–Ω–æ –≤—ã —Ç–∞–∫ –∂–µ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏—Ö –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä
`arui-scripts docker-build name=container-name version=0.1-beta`

–ö–æ–º–∞–Ω–¥–∞ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö `node_modules` –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π, –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç—ã –∂–µ –æ—á–∏—â–∞–µ—Ç –¥–µ–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—è `yarn` –∏–ª–∏ `npm`.
yarn –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–æ–≥–¥–∞ –≤ —Ä—É—Ç–æ–≤–æ–π –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –µ—Å—Ç—å `yarn.lock` –∏ `yarn` –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ.

–ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å `nginx` –∏ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ `nginx` –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å `nodejs` —Å–µ—Ä–≤–µ—Ä–æ–º.

–í –∏—Ç–æ–≥–µ, –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –≤–∞—à–µ–≥–æ –¥–æ–∫–µ—Ä-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤–∞–º –Ω–∞–¥–æ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å

```
docker run -p 8080:8080 container-name:version ./start.sh
```

–ù–∞ `8080` –ø–æ—Ä—Ç—É –±—É–¥–µ—Ç –ø–æ–¥–Ω—è—Ç nginx, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–∑–¥–∞–≤–∞—Ç—å —Å—Ç–∞—Ç–∏–∫—É –∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ `nodejs`.

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏ docker-–æ–±—Ä–∞–∑–∞, —Å–æ–∑–¥–∞–≤ –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ `Dockerfile` —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π. –ü—Ä–∏–º–µ—Ä [Dockerfile](src/templates/dockerfile.template.js).

archive
---

–ö–æ–º–∞–Ω–¥–∞ `arui-scripts archive-build` –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏—é –ø—Ä–æ–¥–∞–∫—à–Ω –≤–µ—Ä—Å–∏–∏ –∏ —Å–±–æ—Ä–∫—É –∞—Ä—Ö–∏–≤–∞ —Å–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–æ–¥–æ–º.

–≠—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–µ–ø–ª–æ–∏—Ç—å –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –≤ –º–∞—Ä–∞—Ñ–æ–Ω–µ.

–ö–æ–º–∞–Ω–¥–∞ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö `node_modules` –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π, –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç—ã –∂–µ –æ—á–∏—â–∞–µ—Ç –¥–µ–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—è `yarn` –∏–ª–∏ `npm`.
yarn –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–æ–≥–¥–∞ –≤ —Ä—É—Ç–æ–≤–æ–π –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –µ—Å—Ç—å `yarn.lock` –∏ `yarn` –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ.

–ò—Ç–æ–≥–æ–≤—ã–π –∞—Ä—Ö–∏–≤ –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤ —Å–µ–±–µ `.build`, `node_modules`, `package.json` –∏ `config` –ø–∞–ø–∫–∏ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.

–ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ –±—ç–∫–µ–Ω–¥–∞.
---

–í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤–∞—à —Ñ—Ä–æ–Ω—Ç –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ API, –æ—Ç–ª–∏—á–Ω–æ–º—É –æ—Ç –≤–∞—à–µ–≥–æ nodejs —Å–µ—Ä–≤–µ—Ä–∞, –≤ –¥–µ–≤ —Ä–µ–∂–∏–º–µ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤.
–°–¥–µ–ª–∞—Ç—å —ç—Ç–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—è —Å–≤–æ–π—Å—Ç–≤–æ `proxy` –≤ –≤–∞—à–µ–º `package.json`.

–ù–∞–ø—Ä–∏–º–µ—Ä:

```json
{
    "proxy": {
        "/corp-shared-ui": {
            "target": "http://corpint4",
            "headers": {
                "host": "corpint4"
            }
        }
    }
}
```

–¢–∞–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ `http://localhost:8080/corp-shared-ui/` –Ω–∞ `http://corpint4/corp-shared-ui`.
–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Webpack](https://webpack.js.org/configuration/dev-server/#devserver-proxy).

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è typescript
---

–ö–æ–º–ø–∏–ª—è—Ü–∏—è TS —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏, –µ—Å–ª–∏ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –µ—Å—Ç—å —Ñ–∞–π–ª `tsconfig.json`.
–ó–∞ –æ—Å–Ω–æ–≤—É –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥:

```json
{
    "extends": "./node_modules/arui-scripts/tsconfig.json"
}
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é TS –±—É–¥–µ—Ç –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ babel, –Ω–æ —É —ç—Ç–æ–≥–æ –µ—Å—Ç—å —Ä—è–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π:
- –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å namespace
- –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å import/export (`import foo = require(...)`, `export = foo`)
- enum merging

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —á—Ç–æ-—Ç–æ –∏–∑ –≤—ã—à–µ–ø–µ—Ä–∏—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ - –≤—ã –º–æ–∂–µ—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é tsc –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ ts —Ñ–∞–π–ª–æ–≤

```json
{
    "aruiScripts": { "useTscLoader": true }
}
```

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx
---

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ nginx –∏–º–µ–µ—Ç –≥–æ—Ç–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥ —Å —Ä–æ—É—Ç–∏–Ω–≥–æ–º, –∏–Ω–æ–≥–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–æ–±–∞–≤–ª—è—Ç—å —Å–≤–æ–∏ —Ä–æ—É—Ç—ã.
–î–ª—è —ç—Ç–æ–≥–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å `nginx.conf` –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ —Å–≤–æ–∏–º–∏ —Ä–æ—É—Ç–∞–º–∏. –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞ [—Ç—É—Ç](src/templates/nginx.conf.template.ts).


–£–¥–∞–ª–µ–Ω–∏–µ proptypes
---

–¢–∞–∫ –∫–∞–∫ –≤ production —Ä–µ–∂–∏–º–∏ proptypes –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è, –∏—Ö –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —É–¥–∞–ª–∏—Ç—å –∏–∑ production —Å–±–æ—Ä–∫–∏.

–°–∞–º–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è proptypes —É–¥–∞–ª—è—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é [babel-plugin-transform-react-remove-prop-types](https://www.npmjs.com/package/babel-plugin-transform-react-remove-prop-types).
–ù–æ –∏–º–ø–æ—Ä—Ç—ã –ø–∞–∫–µ—Ç–æ–≤ `prop-types` –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è. –ß—Ç–æ–±—ã —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `webpack.NormalModuleReplacementPlugin`.
–° –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –ø—É—Å—Ç—ã—à–∫—É –ø–∞–∫–µ—Ç—ã, –ø–æ–ø–∞–¥–∞—é—â–∏–µ –ø–æ–¥ –º–∞—Å–∫—É:

- `/^react-style-proptype$/`
- `/^thrift-services\/proptypes/`

–ï—Å–ª–∏, –ø–æ –∫–∞–∫–æ–π —Ç–æ –ø—Ä–∏—á–∏–Ω–µ, –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ —Ç–∞–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è - –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å –µ–≥–æ, –¥–æ–±–∞–≤–∏–≤ –≤ `package.json`:

```json
{
    "aruiScripts": {
        "keepPropTypes": true
    }
}
```

require –Ω–µ js —Ñ–∞–π–ª–æ–≤ –≤ node_modules –≤ node.js
---
–°–±–æ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏ —É—Å—Ç—Ä–æ–µ–Ω–∞ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å `node_modules` –Ω–µ –≤–∫–æ–º–ø–∏–ª–∏–≤–∞–µ—Ç—Å—è
–≤ –∏—Ç–æ–≥–æ–≤—ã–π –±–∞–Ω–¥–ª, –∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º `require` node.js. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ - —ç—Ç–æ –Ω–∞–º –∏ –Ω—É–∂–Ω–æ.
–ù–æ –≤ —Å–ª—É—á–∞–µ react-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –º—ã –∑–∞—á–∞—Å—Ç—É—é –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –∫—Ä–æ–º–µ –∫–æ–¥–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –µ—â–µ –∏ `.css`, `.png` –∏ –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã.
require node.js –Ω–∞ —Ç–∞–∫–∏—Ö –º–µ—Å—Ç–∞—Ö –ª–æ–º–∞–µ—Ç—Å—è. –ü–æ—ç—Ç–æ–º—É –Ω–∞—à–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤—Å–µ –∂–µ –≤–∫–æ–º–ø–∏–ª–∏–≤–∞—é—Ç—Å—è
–≤ –∏—Ç–æ–≥–æ–≤—ã–π –±–∞–Ω–¥–ª —Å–µ—Ä–≤–µ—Ä–∞. –≠—Ç–æ —Å–¥–µ–ª–∞–Ω–Ω–æ —Å –ø–æ–º–æ—â—å—é [–¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏—Ö –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ](src/configs/webpack.server.dev.ts#L59)
–ø–ª–∞–≥–∏–Ω–∞ [webpack-node-externals](https://www.npmjs.com/package/webpack-node-externals).
–í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ-js —Ñ–∞–π–ª–æ–≤ –∏–∑ –¥—Ä—É–≥–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö –º–æ–¥—É–ª–µ–π - –≤—ã –º–æ–∂–µ—Ç–µ
–≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–µ—Ö–∞–Ω–∏–∑–º–æ–º `overrides`, –æ–ø–∏—Å–∞–Ω–Ω—ã–º –Ω–∏–∂–µ.
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∂–µ –≤—Å–µ –Ω–µ-js —Ñ–∞–π–ª—ã –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –º–æ–¥—É–ª–µ–π –±—É–¥—É—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã.



–¢–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
===
–ï—Å–ª–∏ –≤–∞–º –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `arui-scripts`, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π –ø–ª–∞–≥–∏–Ω –¥–ª—è –≤–µ–±–ø–∞–∫–∞ -
–≤—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–µ—Ö–∞–Ω–∏–∑–º–æ–º `overrides`.

–î–ª—è —ç—Ç–æ–≥–æ –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –≤ –∫–æ—Ä–Ω–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ —Ñ–∞–π–ª `arui-scripts.overrides.js`, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã —Å–º–æ–∂–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å
–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø–æ—á—Ç–∏ –≤—Å–µ—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ `arui-scripts`.

–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã —Ç—É—Ç —Å–ª–µ–¥—É—é—â–∏–π. –î–ª—è –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –Ω–∞–±–æ—Ä –∫–ª—é—á–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∏ –±—É–¥—É—Ç –∏—Å–∫–∞—Ç—å –≤ `arui-scripts.overrides.js`,
–í —Å–ª—É—á–∞–µ –µ—Å–ª–∏ —Ç–∞–∫–æ–π –∫–ª—é—á –Ω–∞–π–¥–µ–Ω –∏ —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è - –æ–Ω–∞ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞, –∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –µ–π –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.
–í–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ç–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ç–∞–∫ –∂–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.

–ù–∞–ø—Ä–∏–º–µ—Ä —Ç–∞–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `arui-scripts.overrides.js`:
```javascript
const path = require('path');
module.exports = {
    webpack: (config) => {
        config.resolve.alias = {
            components: path.resolve(__dirname, 'src/components')
        };
        return config;
    }
};
```

–° –ø–æ–º–æ—â—å—é —ç—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–æ –≤—Å–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –≤–µ–±–ø–∞–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω `alias` *components*.

–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- `babel-client` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `babel` –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–¥–∞. –ö–ª—é—á–∏: `babel`, `babelClient`.
- `babel-server` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `babel` –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–æ–≥–æ –∫–æ–¥–∞. –ö–ª—é—á–∏: `babel`, `babelServer`.
- `dev-server` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `webpack-dev-server`. –ö–ª—é—á–∏: `devServer`.
- `postcss` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è `postcss`. –ö–ª—é—á–∏: `postcss`.
  > `config` postcss —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∞—Å—Å–∏–≤ —Å —É–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–ª–∞–≥–∏–Ω–∞–º–∏, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ—Ç–æ—Ä—ã—Ö —É–∂–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã. –ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–ª–∞–≥–∏–Ω–æ–≤ –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º:
    ```javascript
    const {
        createPostcssConfig, // —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ postcss
        postcssPlugins, // —Å–ø–∏—Å–æ–∫ –ø–ª–∞–≥–∏–Ω–æ–≤
        postcssPluginsOptions, // –∫–æ–ª–ª–µ–∫—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –ø–ª–∞–≥–∏–Ω–æ–≤
    } = require('arui-scripts/build/configs/postcss.config');

    module.exports = {
        postcss: () => {
            const newOption = {
                ...postcssPluginsOptions,
                'postcss-import': {
                    ...postcssPluginsOptions['postcss-import'],
                    path: [...postcssPluginsOptions['postcss-import'].path, './src'],
                },
            };
            return createPostcssConfig(postcssPlugins, newOption);
        },
    };
    ```
- `stats-options` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è [webpack-stats](https://webpack.js.org/configuration/stats/). –ö–ª—é—á–∏: `stats`.
- `webpack.client.dev` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ webpack –≤ dev —Ä–µ–∂–∏–º–µ. –ö–ª—é—á–∏: `webpack`, `webpackClient`, `webpackDev`, `webpackClientDev`.
- `webpack.client.prod` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ webpack –≤ prod —Ä–µ–∂–∏–º–µ. –ö–ª—é—á–∏: `webpack`, `webpackClient`, `webpackProd`, `webpackClientProd`.
- `webpack.server.dev` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ webpack –≤ dev —Ä–µ–∂–∏–º–µ. –ö–ª—é—á–∏: `webpack`, `webpackServer`, `webpackDev`, `webpackServerDev`.
- `webpack.server.prod` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ webpack –≤ prod —Ä–µ–∂–∏–º–µ. –ö–ª—é—á–∏: `webpack`, `webpackServer`, `webpackProd`, `webpackServerProd`.
- `supporting-browsers` - —Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ [browserslist](https://github.com/browserslist/browserslist). –ö–ª—é—á–∏: `browsers`, `supportingBrowsers`

–î–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª—é—á–µ–π, –æ–Ω–∏ –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ.

---
## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–±–∏—Ç –Ω–∞ –¥–≤–∞ –ø–∞–∫–µ—Ç–∞: `arui-scripts`, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ `arui-scripts-test`, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π
–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞–∫–µ—Ç–∞–º–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è [yarn workspaces](https://classic.yarnpkg.com/en/docs/workspaces/).
–î–ª—è
